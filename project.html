<!doctype html>
<html>

<head>
    <title>Enter Game Name Here</title>
    <!--Phaser library version: 2.6.2-->
    <script src="lib/phaser.min.js"></script>
	<script src="lib/jquery-3.1.1.min.js"></script>

    <!-- Import all our javascript files here -->
    <script src="js/preloader.js"></script>
    <script src="js/Click.js"></script>
    <script src="js/LightningSpell.js"></script>
    <script src="js/RandomGeneration.js"></script>
    <script src="js/Levels/Level1.js"></script>
	<script src = "js/levelmanager.js"></script>
</head>

<body>


    <script type="text/javascript">
//<!--Game code goes here-->


//<!--Variables for basic elements in game-->
var current_click = null;       // this is the player's current click. is null when not clicking




//var game = new Phaser.Game(1334, 750, Phaser.AUTO);
//game.state.add("Level_1", LEVELS.ONE);
//game.state.start("Level_1");


//var level_time = 50;
var player;

var required_gap_top = 96 + 96 / 2;       // 96 + 48 = 144
var required_gap_bot = 750 - 96 / 2;      // game.world.height (750) - 48 = 712

var player_grav = 700;
var player_jump_speed = 400;

var player_can_jump = false;

//var lightningSpells = [];
//<!--End of basic elements-->

//<!--Variables for dialogue and displaying-->
var upKey;										//The key for testing text displaying
var spKey;

var dialogue = jQuery.parseJSON(				//All dialogue text is stored in the JSON file
	jQuery.ajax({								//JSON.parse() will parse json before ajac call is finished
		url: "js/dialogue.json",				//and this will error and make the dialogue empty
		async: false,							//This will block the browser until ajax call is finished
		dataType: "json"
	}).responseText
);

var textDisplaying = false;
var currentText = new Text(game, 200, 600, dialogue.crush);


//var currentLevel = null;
var levelManager = new Phaser.StateManager(game);

var game = new Phaser.Game(1334, 750, Phaser.AUTO, "[INSERT GAME NAME HERE]");
game.state.add("Level_1", Level1);
game.state.start("Level_1");

//<!--End of dialogue-->

        //<!--upon creation of the game-->
/*
function create()
{
	upKey = game.input.keyboard.addKey(Phaser.Keyboard.UP);		//the key for testing dialogue display
	downKey = game.input.keyboard.addKey(Phaser.Keyboard.DOWN);
	spKey = game.input.keyboard.addKey(Phaser.Keyboard.SPACE);
	spKey.onDown.add(RestartGame, this);
	upKey.onDown.add(addtext, this);
	downKey.onDown.add(removetext, this);
	
	//alert(dialogue.crush);

    game.physics.startSystem(Phaser.Physics.ARCADE);

    game.input.mouse.capture = true;    // track the mouse
    game.time.advancedTiming = true;    // allow an fps counter without my having to make one

    // setting up the background images
    var start_x = 0;
    var start_y = game.world.height / 2;

    console.log("About to create the level class");
    currentLevel = new Level1(level_time, start_x, start_y);
 

    // player
    player = game.add.sprite(currentLevel.start_x, currentLevel.test_ground.y - currentLevel.test_ground.height - 96, "player_sprite");
    game.physics.arcade.enable(player);
    player.body.gravity.y = player_grav;
    player.body.bounce.y = .1;
    player.body.collodeWorldBounds = true;  // although honestly the player should never move horizontally ANYway

    player.animations.add("run", [1,2,3,4,5, 6, 7], 10, true);
    player.animations.play("run");


    // music
    var music = game.add.audio('frankenstein');
    music.play();
    
    


}
*/
//<!--End of create()-->

//<!--This function is loaded every frame-->

/*
function update()
{

    currentLevel.Update();


    // collide the player with the platforms
    if (game.physics.arcade.collide(player, currentLevel.platforms))         // if they are colliding, the player will stand still and slide along with the platforms!
    {
        player.body.velocity.x = currentLevel.platform_scrolling_speed;
        player_can_jump = true;
    }
    else
    {
        player.body.velocity.x = 0;
        player_can_jump = false;
    }


    if( game.input.activePointer.leftButton.isDown )        // if clicking
    {
        if( !current_click )       // if current_click === null
        {
            var time = game.time.now;
            var mouseX = game.input.mousePointer.x;
            var mouseY = game.input.mousePointer.y;
            current_click = new Click(mouseX, mouseY, time);
        }
        else                        // current click exists
        {
            if( game.time.now - current_click.startT >= 500 )
            {
                // start doing charge animation for the player to use a bomb
                console.log("charging bomb...");
            }
        }
    }
    else
    {
        if( current_click )     // if current_click !== null
        {
            var time = game.time.now;
            var mouseX = game.input.mousePointer.x;
            var mouseY = game.input.mousePointer.y;
            current_click.endClick(mouseX, mouseY, time);

            // now do all the proper testing
            if ( current_click.type === "tap" )
            {
                if( player_can_jump )
                {
                    player.body.velocity.y = -player_jump_speed;  // arbitrary number. (but it is the same as what gravity is... For now, it's the height the player jumps to hit the next platform)
                    // we could also set "player_can_jump" back to false here, but it should already be taken care of
                }
            }
            else if ( current_click.type === "swipe right" )
            {
                // cooldown test
            }
            else if ( current_click.type === "swipe left" )
            {
                // cooldown test
            }
            else if ( current_click.type === "swipe up")
            {
                // cooldown test
            }
            else if (current_click.type === "swipe down")
            {
                // cooldown test
                console.log("Casting lightning!");
                new LightningSpell(current_click, .2);
            }
            else if (current_click.type === "hold")
            {
                // cooldown/availability test
            }

            // allow the player to be able to click again after we do the proper response to the player's click
            current_click = null;   //
        }
    }



    // play all the current animations
    var i = 0;
    while( i < lightningSpells.length )
    {
        var temp = lightningSpells[i];//lightningSpells[i].Play();
        temp.Play();
        i++;
    }

}
*/


//<!--End of dialogue-->



function addtext(curText)
{
	//console.log(currentText);
	var style = {font: "25px assets/8-BIT WONDER.TTF", fill: "#ffffff"};
	game.add.sprite(0, 550, "textBox");
	game.add.text(60, 600, dialogue.crush, style);
}

function removetext()
{
	textBox.destroy();
	
}

function RestartGame()
{
	levelManager.restart(true, false);
}


    </script>

</body>
</html>